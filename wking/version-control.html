<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="scb.css" type="text/css"/>
    <title>Software Carpentry: Version Control with Git</title>
    <meta name="provenance" content="$Id: $"/>

  </head>
  <body class="firstdraft">
    <h1>Software Carpentry: Version Control with Git</h1>

    <p>
      Suppose that Wolfman and Dracula have been hired by Universal Monsters Inc.
      to figure out where the company should put its next secret lair.
      They want to be able to work on the plans at the same time,
      but they have both run into problems doing this in the past.
      If they take turns they will each spend a lot of time waiting for the other to finish,
      but if they each work on their own copy at the same time
      or email changes back and forth
      they know that things will be lost, overwritten, or duplicated.
    </p>

    <p class="fixme">image of Wolfman and Dracula collaborating, with public and private repositories</p>

    <p>
      The right solution is to use a <a href="glossary.html#version-control-system">version control system</a>.
      These systems keeps track of the project's history in a <a href="glossary.html#repository">repository</a>.
      Wolfman creates a new repository for the project,
      and publishes a copy of the repository where Dracula can find it.
      Now Wolfman can start making changes to his private repository.
      Dracula <a href="glossary.html#clone">clones</a> Wolfman's repository,
      creating his own private copy.
      Now Dracula can start making changes to his private repository.
    </p>

    <p>
      As soon Wolfman feels like he has completed a logical change
      (for example, fixing any &#8220;secret liar&#8221; typos),
      he <a href="glossary.html#commit">commits</a> his work to his repository.
      He can go on making several successive commits in private.
      When is ready to share his changes,
      he <a href="glossary.html#push">pushes</a> his changes to his public repository.
      Dracula can then <a href="glossary.html#fetch">fetch</a> Wolfman's public repository to see those changes.
      Now Dracula can look over Wolfman's changes and decide if they make sense.
      If everything looks good, Dracula can <a href="glossary.html#merge">merge</a> Wolfman's changes, accepting the changes into his own work.
      And of course,
      when Dracula finishes working on something,
      he can commit and push his changes to his public repository,
      which Wolfman can fetch and merge.
    </p>

    <p class="fixme">image of Wolfman and Dracula committing</p>

    <p>
      But what if Dracula and Wolfman make changes to the same part of their working copies?
      This is actually fairly uncommon in a small, well-run project.
      When it <em>does</em> happen,
      the version control system helps people reconcile their changes.
    </p>

    <p>
      Say, for example,
      that Wolfman and Dracula are making changes at the same time,
      and Wolfman pushes his changes to his public repository.
    </p>

    <p class="fixme">Wolfman commits</p>

    <p class="continue">
      Then Dracula fetches Wolfman's changes and tries to merge them with his own work,
      but the version control system stops him
      and points out the <a href="glossary.html#conflict">conflict</a>:
    </p>

    <p class="fixme">Dracula has a conflict</p>

    <p class="continue">
      Dracula must <a href="glossary.html#resolve">resolve</a> that conflict
      before the version control system will allow him to commit his work.
      He can accept what Wolfman did,
      replace it with what he has done,
      or write something new that combines the two&#8212;that's up to him.
      Once he has fixed things, he can go ahead and commit and push the new work to his public repository.
    </p>

    <p>
      Version control is better than mailing files back and forth for at least three reasons.
      First, it's hard (but not impossible) to accidentally overlook or overwrite someone's changes,
      because the version control system highlights them automatically.
      Second, there are no arguments about whose copy is the most up to date&#8212;they each have a log of all the work that has been pushed to public repositories.
    </p>

    <p>
      Third, nothing that is committed to version control is ever lost,
      so it acts like the <em>undo</em> feature in an editor.
      Version control can do this because
      it never actually overwrites the master copy in the repository.
      Instead, every time someone commits a new version it is saved on top of the previous one:
    </p>

    <p class="fixme">picture of versions stacked up</p>

    <p class="continue">
      Since all old versions are saved
      it's always possible to go back in time to see exactly who wrote what on a particular day,
      or what version of a program was used to generate a particular set of results.
    </p>

    <p>
      Version control systems do have one important shortcoming.
      It is easy for them to find and display differences in text files,
      and to help you merge them.
      Images, MP3s, PDFs, or Microsoft Word or Excel files aren't stored as text,
      though&#8212;they use specialized binary data formats.
      Most version control systems don't know how to deal with these formats,
      so all they can say is, &#8220;These files differ.&#8221;
      The rest is up to you.
    </p>

    <p>
      Even with this limitation,
      version control is one of the most important concepts in this book.
      The rest of this chapter will explore how to use Git,
      a popular open source version control system.
    </p>

    <div class="sect" id="s:setup">

      <h2>
        Repository Setup
      </h2>

      <p>
        To track a project with version control,
        Dracula needs to create a <a href="glossary.html#repository">repository</a> to hold the project's history.
        Dracula's been involved in a few projects over the years,
        and he stays organized by keeping all the source code in a <code>~/src</code> subdirectory of his home directory.
        He create a directory for this new project
      </p>

<pre>
<span class="out">$ </span><span class="in">mkdir ~/src/monsters</span>
</pre>

      <p>
        Then he changes into that directory and initializes the repository.
      </p>

<pre>
<span class="out">$ </span><span class="in">cd ~/src/monsters</span>
<span class="out">$ </span><span class="in">git init</span>
<span class="out">Initialized empty Git repository in /home/dracula/src/monsters/.git/</span>
</pre>

      <p>
        This creates a new subdirectory (<code>.git</code>) that holds all the repository data needed by Git.
        Because this is his first project using Git,
        Dracula should tell Git his name and email,
        which will be stored in any commits he makes.
      </p>

<pre>
<span class="out">$ </span><span class="in">git config --global user.name Dracula</span>
<span class="out">$ </span><span class="in">git config --global user.email dracula@umi.com</span>
</pre>

      <p>
        Without the <code>--global</code> option,
        these configuration options would only apply to the <code>monsters</code> project.
      </p>

    </div>

    <div class="sect" id="s:basics">

      <h2>
        Basic Use
      </h2>

      <p>
        As we said in the introduction,
        Dracula and Wolfman are trying to figure out
        where Universal Monsters should hide its next secret lair.
        It's Monday night.
        Dracula thinks it might be a good idea to put the lair on one of Jupiter's moons,
        so he starts working on a file full of physical constants using his editor of choice.
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Calisto         1882.7          16.689018       1075.9          2410.3
</pre>

      <p>
        Four moons is enough to consider for one day,
        so Dracula wants to commit the file to his repository,
        checkpointing the file at its current state.
        First, he tells Git that it should track the file.
        This isn't the same as creating it&#8212;Dracula has already done that with his editor.
        Instead, adding the file tells Git to start keeping track of changes to that file.
        It's quite common,
        particularly in programming projects,
        to have backup files or artifacts of compilation in a directory that aren't worth storing in the repository.
        This is why version control requires you to explicitly tell it which files are to be managed.
      </p>

<pre>
<span class="out">$ </span><span class="in">git add moons.txt</span>
</pre>

      <p>
        Now, he can commit the file in its current state.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "Add Jupiter's moons (Io, Europa, Ganymede, and Calisto)." moons.txt</span>
<span class="out">[master (root-commit) 7c0da88] Add Jupiter's moons (Io, Europa, Ganymede, and Calisto).
 1 file changed, 5 insertions(+)
 create mode 100644 moons.txt</span>
</pre>

      <p>
        Since the commit comment he wants to provide is short,
        he gives it to Git on the command line
        using the <code>-m</code> flag.
        (He puts it in quotation marks so that the shell will treat it as a single string&#8212;without
        them, it would think the first word of the comment was the argument to <code>-m</code>
        and then complain that it didn't understand the rest of the sentence).
        If he doesn't provide a comment with <code>-m</code>,
        Git will run <a href="http://www.kernel.org/pub/software/scm/git/docs/git-var.html#GIT_EDITOR">his editor</a> and give him a chance to write something there.
      </p>

      <p>
        The commit message after <code>-m</code> can be anything you like,
        but Dracula knows that moons can make Wolfman a little crazy and
        wants to give him a helpful hint about which planet they are orbiting.
        Good comments are as important in version control as they are in coding.
        Without them, it can be very difficult to figure out what the initial committer was thinking when you trying and debug their code in three years.
        We can use comments like, &#8220;Changed things,&#8221; and, &#8220;Fixed it,&#8221; if we want,
        but we'll only be creating trouble for our future selves.
      </p>

      <p>
        In order to create his own copy of the repository,
        Wolfman has to <a href="glossary.html#clone">clone</a> Dracula's repository.
        He only has to do this once per project:
        once he has a working copy,
        he can update it over and over again to get other people's work:
      </p>

      <p class="fixme">picture of distributed development</p>

      <p>
        To clone Dracula's repository,
        Wolfman needs to know the
        <a href="http://www.kernel.org/pub/software/scm/git/docs/git-clone.html#URLS">URL</a>
        of the repository,
        which tells Git where to look.
        Because Wolfman has file system access to Dracula's repository,
        he can use the <code>~dracula/src/monsters</code> for the URL.
        This is Wolfman's first project,
        but Dracula told him that staying organized is important,
        so he creates a source directory to store all his project.
        Then Wolfman clones Dracula's repository.
      </p>

<pre>
<span class="out">$ </span><span class="in">mkdir ~/src</span>
<span class="out">$ </span><span class="in">cd ~/src</span>
<span class="out">$ </span><span class="in">git clone ~dracula/src/monsters</span>
<span class="out">Cloning into 'monsters'...
done.</span>
</pre>

      <p>
        When Wolfman runs the <code>clone</code> command,
        Git retrieves the repository data from Dracula's repository
        and stores them in a new subdirectory of Wolfman's current directory.
        Once the clone is complete,
        Wolfman can change into the new directory and see Dracula's work.
      </p>

<pre>
<span class="out">$ </span><span class="in">cd monsters</span>
<span class="out">$ </span><span class="in">cat moons.txt</span>
<span class="out">Name            Orbital Radius  Orbital Period  Mass            Radius
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Calisto         1882.7          16.689018       1075.9          2410.3</span>
</pre>

      <p>
        Wolfman can find out more about the history of the project by using Git's <code>log</code> command.
        When he runs <code>git log</code>,
        Git displays a summary of all the changes made to the project so far.
        This list includes the <a href="glossary.html#hash">commit hash</a>,
        the name of the person who made the change,
        the date the change was made,
        and whatever comment the user provided when the change was submitted.
        As we can see,
        there has only been one commit to the <code>monsters</code> project so far,
        and it was made by Dracula:
      </p>

<pre>
<span class="out">$ </span><span class="in">git log</span>
<span class="out">commit 7c0da882b9df3b3fe003b7caa05ba6faff9c8b90
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:13:13 2005 -0700

    Add Jupiter's moons (Io, Europa, Ganymede, and Calisto).</span>
</pre>

      <p>
        Notice that the commit is named with a <a href="glossary.html#hash">hash</a>.
        Centralized version control systems usually use an incremented integer (&#8220;version 1&#8221;, followed by &#8220;version 2&#8221;, followed by &#8220;version 3&#8221;, &#8230;).  
        This is less common in distributed systems,
        because when you change version 1,
        you'd expect to create version 2.
        However, your co-developer may have already altered version 1,
        and thinks that their commit should be version 2,
        and yours should be version 3.
        Rather than argue over this sort of thing,
        distributed version control systems generate commit hashes that uniquely represent a commit,
        and use these hashes to refer to the commits
        (&#8220;version 7c0da882b9df3b3fe003b7caa05ba6faff9c8b90&#8221;).
        Because the full hash is a pain to type,
        you can abbreviate it as much as you like,
        so long as the abbreviation is unambiguous.
        For example, if there was another commit 7c0da0&#8230;,
        you could refer to Dracula's commit as 7c0da8
        (or 7c0da88, or 7c0da882, &#8230;).
      </p>

      <p>
        The commit hash applies to the commit message and a particular state of each versioned file.
        When we talk about &#8220;version 7c0da8&#8221;, we mean,
        &#8220;The state of all files and directories at that point.&#8221;
        Older version control systems like CVS gave each file a new version number when it was updated,
        which meant that version 38 of one file could correspond in time to version 17 of another:
      </p>

      <p class="fixme">picture of CVS and Git version numbering</p>

      <p class="continue">
        Experience shows that
        global commit hashes numbers that apply to everything in the repository
        are easier to manage than
        per-file version numbers,
        so that's what Git uses.
      </p>

      <p>
        Wolfman expects to be making changes to Git repositories,
        and he has yet to tell Git his preferred name and email,
        so he does that now.
      </p>

<pre>
<span class="out">$ </span><span class="in">git config --global user.name Wolfman</span>
<span class="out">$ </span><span class="in">git config --global user.email wolf@umi.com</span>
</pre>

      <p>
        Looking in the new file <code>moons.txt</code>,
        Wolfman notices that Dracula has misspelled &#8220;Callisto&#8221;
        (it is supposed to have two L's.)
        Wolfman edits that line of the file:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
</pre>

      <p class="continue">
        He then commits his changes to his repository.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "moons: fix typo Calisto -&gt; Callisto." moons.txt</span>
<span class="out">[master de55da5] moons: fix typo Calisto -&gt; Callisto.
 1 file changed, 1 insertion(+), 1 deletion(-)</span>
</pre>

      <p>
        He also adds a line about Amalthea,
        which he thinks might be a good site for a secret lair despite its small size:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
Amalthea        181.4           0.498179        0.075           125.0
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
</pre>

      <p class="continue">
        He then commits the Amalthea addition.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "moons: add Amalthea" moons.txt</span>
<span class="out">[master 11cddc9] moons: add Amalthea
 1 file changed, 1 insertion(+)</span>
</pre>

      <p>
        Hmm, perhaps that commit message could have been more detailed.
        Wolfman re-commits, using a more detailed commit message.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit --amend -m "moons: add Amalthea (nicer view of Jupiter)." moons.txt</span>
<span class="out">[master 7edafb0] moons: add Amalthea (nicer view of Jupiter).
 1 file changed, 1 insertion(+)</span>
</pre>

      <p class="aside">
        This is one of the situations where Git is different from many other
        version control systems.
        Git provides a rich set of commands for editing your history.
        For more involved reconstruction,
        you can <a href="#s:rollback">rewind earlier commits</a>,
        <a href="http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html">
          rebase earlier commits</a>, or
        <a href="http://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html">
          use scripts to rewrite your whole history</a>.
        For basic version control,
        you won't need to dig this deep into the Git toolbox,
        but it's good to know these features are there if you need them.
        See the
        <a href="http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html#_recovering_from_upstream_rebase">
          <code>RECOVERING FROM UPSTREAM REBASE</code></a> section of
        <a href="http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html">
          <code>git rebase --help</code></a>
        for warnings against altering public commits.
        Altering private commits,
        where noone else has had a chance to pull the commit,
        does not suffer from these complications.
      </p>

      <p>
        Wolfman's getting into the swing of things now,
        so he also adds information about Himalia and Elara.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "moons: add Himalia and Elara (small, but closer to big moons)." moons.txt</span>
<span class="out">[master 7c8b64a] moons: add Himalia and Elara (small, but closer to big moons).
 1 file changed, 2 insertions(+)</span>
</pre>

      <p>
        That night,
        when Dracula rises from his coffin to start work,
        the first thing he wants to do is get Wolfman's changes.
        He hasn't told Git where to find Wolfman's repository yet,
        so he does that now,
        adding a <a href="glossary.html#remote-repository">remote repository</a>.
      </p>

<pre>
<span class="out">$ </span><span class="in">git remote add wolfman ~wolfman/src/monsters</span>
</pre>

      <p>
        Dracula uses Git's <code>fetch</code> command to fetch all the commits from Wolfman's repository.
        This doesn't affect Dracula's development,
        it just downloads Wolfman's data so Dracula can look through it.
      </p>

<pre>
<span class="out">$ </span><span class="in">git fetch wolfman</span>
<span class="out">From /home/wolfman/src/monsters
 * [new branch]      master     -&gt; wolfman/master</span>
</pre>

      <p>
        Wolfman's committed work show up as a new <a href="glossary.html#branch">branch</a>.
        Dracula can then see what has changed in Wolfman's branch relative to his own <a href="glossary.html#head">head</a>.
      </p>

<pre>
<span class="out">$ </span><span class="in">git log HEAD..wolfman/master</span>
<span class="out">commit 7c8b64a1762c4701a4068e601dfe8ad56e591bda
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:16:13 2005 -0700

    moons: add Himalia and Elara (small, but closer to big moons).

commit 7edafb02ba4719cdd0a59ae3759dc470dfb24e31
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:15:13 2005 -0700

    moons: add Amalthea (nicer view of Jupiter).

commit de55da5cb2aa7b48fbe9e859894c1ee1b472fa4b
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:14:13 2005 -0700

    moons: fix typo Calisto -&gt; Callisto.</span>
</pre>

     <p>
       Dracula things those all sound like reasonable things to do,
       but he also wants to see exactly what Wolfman did with all those changes, so he uses Git's <code>diff</code> command.
       There are a number of options you can pass <code>diff</code> to get the exact output format you want.
       In this case,
       Dracula wants colored word-by-word differences
       (<code>--word-diff=color</code>)
       and he wants to see changes from his working directory to Wolfmans branch
       (<code>-R</code>).
      </p>

<pre>
<span class="out">$ </span><span class="in">git diff --word-diff=color -R wolfman/master</span>
<span class="out"><span style="font-weight: bold">diff --git b/moons.txt a/moons.txt</span>
<span style="font-weight: bold">index 2634a4e..b898ee5 100644</span>
<span style="font-weight: bold">--- b/moons.txt</span>
<span style="font-weight: bold">+++ a/moons.txt</span>
<span style="color: cyan">@@ -1,5 +1,8 @@</span>
Name            Orbital Radius  Orbital Period  Mass            Radius
<span style="color: green">Amalthea        181.4           0.498179        0.075           125.0</span>
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
<span style="color: red">Calisto</span><span style="color: green">Callisto</span>        1882.7          16.689018       1075.9          2410.3
<span style="color: green">Himalia         11460           250.5662        0.095           85.0</span>
<span style="color: green">Elara           11740           259.6528        0.008           40.0</span></span>
</pre>

      <p>Everything looks good!  Time to merge</p>

<pre>
<span class="out">$ </span><span class="in">git merge wolfman/master</span>
<span class="out">Updating 7c0da88..7c8b64a
Fast-forward
 moons.txt | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)</span>
</pre>

      <p>
        This is a very common workflow:
        check to see if there have been any changes in the repository,
        and if they are not going to get in the way,
        merge them into our working copy.
        It's worth noticing here how important Wolfman's comments about his changes were.
        Without Wolfman's comments,
        Dracula might have wasted time wondering why Wolfman was bothering with the tiny moons.
      </p>

    </div>

    <div class="sect" id="s:merge">

      <h2>
        Merging Conflicts
      </h2>

      <p>
        Dracula now edits his copy to change Amalthea's radius
        from a single number to a triple to reflect its irregular shape:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
Amalthea        181.4           0.498179        0.075           131 x 73 x 67
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
Himalia         11460           250.5662        0.095           85.0
Elara           11740           259.6528        0.008           40.0
</pre>

      <p class="continue">
        He then commits his work,
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "moons: Amalthea isn't round, give three radii." moons.txt</span>
<span class="out">[master b28000b] moons: Amalthea isn't round, give three radii.
 1 file changed, 1 insertion(+), 1 deletion(-)</span>
</pre>

      <p>
        But while Dracula is doing this,
        Wolfman is editing <em>his</em> copy
        to add information about two other minor moons,
        Himalia and Elara:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
Amalthea        181.4           0.498179        0.075           125.0
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
Himalia         11460           250.5662        0.095           85.0
Elara           11740           259.6528        0.008           40.0
Sinope          23540           724.1           0.00075         19
Pasipha&#235;        24095           764.0820        0.0003          30
<span class="out">$ </span><span class="in">git commit -m "moons: add Sinope and Pasipha&#235; (far out)." moons.txt</span>
<span class="out">[master 75d6a6f] moons: add Sinope and Pasipha&#235; (far out).
 1 file changed, 2 insertions(+)</span>
</pre>

      <p>
        A few minutes after their commits,
        Wolfman decides to syncronize with Dracula.
        He fetches Dracula's repository data
      </p>

<pre>
<span class="out">$ </span><span class="in">git fetch</span>
<span class="out">From /home/dracula/src/monsters
   7c0da88..b28000b  master     -&gt; origin/master</span>
</pre>

      <p class="continue">
        and he takes a look at what's changed.
      </p>

<pre>
<span class="out">$ </span><span class="in">git log HEAD..origin/master</span>
<span class="out">commit b28000b6b3f197942909c51731d17e34739b9689
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:17:13 2005 -0700

    moons: Amalthea isn't round, give three radii.</span>
</pre>

      <p>
        Hmm, let's take a look at a graphical view of the history of
        all the branches Wolfman knows about.
      </p>

<pre>
<span class="out">$ </span><span class="in">git log --graph --all</span>
<span class="out">* commit 75d6a6fed22aa29c33b92257f4849068fe04e848
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:18:13 2005 -0700
| 
|     moons: add Sinope and Pasipha&#235; (far out).
|    
| * commit b28000b6b3f197942909c51731d17e34739b9689
|/  Author: Dracula &lt;dracula@umi.com&gt;
|   Date:   Thu Apr 7 15:17:13 2005 -0700
|   
|       moons: Amalthea isn't round, give three radii.
|  
* commit 7c8b64a1762c4701a4068e601dfe8ad56e591bda
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:16:13 2005 -0700
| 
|     moons: add Himalia and Elara (small, but closer to big moons).
|  
* commit 7edafb02ba4719cdd0a59ae3759dc470dfb24e31
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:15:13 2005 -0700
| 
|     moons: add Amalthea (nicer view of Jupiter).
|  
* commit de55da5cb2aa7b48fbe9e859894c1ee1b472fa4b
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:14:13 2005 -0700
| 
|     moons: fix typo Calisto -&gt; Callisto.
|  
* commit 7c0da882b9df3b3fe003b7caa05ba6faff9c8b90
  Author: Dracula &lt;dracula@umi.com&gt;
  Date:   Thu Apr 7 15:13:13 2005 -0700
  
      Add Jupiter's moons (Io, Europa, Ganymede, and Calisto).</span>
</pre>

      <p>
        Ah, the branches have diverged.
        Wolfman checks the content differences.
      </p>

<pre>
<span class="out">$ </span><span class="in">git diff --word-diff=color -R origin/master</span>
<span class="out"><span style="font-weight: bold">diff --git b/moons.txt a/moons.txt</span>
<span style="font-weight: bold">index 033740d..967161a 100644</span>
<span style="font-weight: bold">--- b/moons.txt</span>
<span style="font-weight: bold">+++ a/moons.txt</span>
<span style="color: cyan">@@ -1,10 +1,8 @@</span>
Name            Orbital Radius  Orbital Period  Mass            Radius
Amalthea        181.4           0.498179        0.075           <span style="color: red">125.0</span><span style="color: green">131 x 73 x 67</span>
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
Himalia         11460           250.5662        0.095           85.0
Elara           11740           259.6528        0.008           40.0
<span style="color: red">Sinope          23540           724.1           0.00075         19</span>
<span style="color: red">Pasipha&#235;        24095           764.0820        0.0003          30</span></span>
</pre>

      <p class="continue">
        The differences don't seem to overlap,
        so Wolfman tries to merge in Dracula's changes.
        Luckily,
        Dracula and Wolfman's edits are sufficiently separated,
        so Git can merge the differences automatically:
      </p>

<pre>
<span class="out">$ </span><span class="in">git merge -m "Merge Dracula's Amalthea radii" origin/master</span>
<span class="out">Auto-merging moons.txt
Merge made by the 'recursive' strategy.
 moons.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)</span>
</pre>

      <p>
        Wolfman's branch history now looks like
      </p>

<pre>
<span class="out">$ </span><span class="in">git log --graph</span>
<span class="out">*   commit a2f10432f3d28c5d2fed826978e38d93cd4fd39f
|\  Merge: 75d6a6f b28000b
| | Author: Wolfman &lt;wolf@umi.com&gt;
| | Date:   Thu Apr 7 15:19:13 2005 -0700
| | 
| |     Merge Dracula's Amalthea radii
| |   
| * commit b28000b6b3f197942909c51731d17e34739b9689
| | Author: Dracula &lt;dracula@umi.com&gt;
| | Date:   Thu Apr 7 15:17:13 2005 -0700
| | 
| |     moons: Amalthea isn't round, give three radii.
| |   
* | commit 75d6a6fed22aa29c33b92257f4849068fe04e848
|/  Author: Wolfman &lt;wolf@umi.com&gt;
|   Date:   Thu Apr 7 15:18:13 2005 -0700
|   
|       moons: add Sinope and Pasipha&#235; (far out).
|  
* commit 7c8b64a1762c4701a4068e601dfe8ad56e591bda
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:16:13 2005 -0700
| 
|     moons: add Himalia and Elara (small, but closer to big moons).
|  
* commit 7edafb02ba4719cdd0a59ae3759dc470dfb24e31
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:15:13 2005 -0700
| 
|     moons: add Amalthea (nicer view of Jupiter).
|  
* commit de55da5cb2aa7b48fbe9e859894c1ee1b472fa4b
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:14:13 2005 -0700
| 
|     moons: fix typo Calisto -&gt; Callisto.
|  
* commit 7c0da882b9df3b3fe003b7caa05ba6faff9c8b90
  Author: Dracula &lt;dracula@umi.com&gt;
  Date:   Thu Apr 7 15:13:13 2005 -0700
  
      Add Jupiter's moons (Io, Europa, Ganymede, and Calisto).</span>
</pre>

      <p>
        Wolfman's branch is now at commit a2f10432,
        but Dracula's is one behind at commit b28000b6.
        At this point, they both decide to add measurement units to the columns in <code>moons.txt</code>.
        Wolfman is quicker off the mark this time;
        he adds a line to the file:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
                (10**3 km)      (days)          (10**20 kg)     (km)
Amalthea        181.4           0.498179        0.075           131 x 73 x 67
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
Himalia         11460           250.5662        0.095           85.0
Elara           11740           259.6528        0.008           40.0
Sinope          23540           724.1           0.00075         19
Pasipha&#235;        24095           764.0820        0.0003          30
</pre>

      <p class="continue">
        and commits it.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "moons: add units header." moons.txt</span>
<span class="out">[master e28f982] moons: add units header.
 1 file changed, 1 insertion(+)</span>
</pre>

      <p>
        While he is doing this, though, Dracula starts editing his copy.
        He also inserts a line at the top of the file,
        but not the same one as Wolfman:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
                * 10^3 km       * days          * 10^20 kg      * km
Amalthea        181.4           0.498179        0.075           131 x 73 x 67
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
<span class="out">$ </span><span class="in">git commit -m "moons: add units for physical data columns." moons.txt</span>
<span class="out">[master 7a139b1] moons: add units for physical data columns.
 1 file changed, 1 insertion(+), 2 deletions(-)</span>
</pre>

      <p>
        Now Dracula decides to synchronize with Wolfman,
        so he fetches Wolfman's repository and looks at the differences.
      </p>

<pre>
<span class="out">$ </span><span class="in">git fetch wolfman</span>
<span class="out">From /home/wolfman/src/monsters
   7c8b64a..e28f982  master     -&gt; wolfman/master</span>
<span class="out">$ </span><span class="in">git log --graph --all</span>
<span class="out">* commit 7a139b1a9e355fde53edb68814de13526708c091
| Author: Dracula &lt;dracula@umi.com&gt;
| Date:   Thu Apr 7 15:21:13 2005 -0700
| 
|     moons: add units for physical data columns.
|    
| * commit e28f982d72e60171beb8ce2ae07f3e0d04cdb3a1
| | Author: Wolfman &lt;wolf@umi.com&gt;
| | Date:   Thu Apr 7 15:20:13 2005 -0700
| | 
| |     moons: add units header.
| |     
| *   commit a2f10432f3d28c5d2fed826978e38d93cd4fd39f
| |\  Merge: 75d6a6f b28000b
| |/  Author: Wolfman &lt;wolf@umi.com&gt;
|/|   Date:   Thu Apr 7 15:19:13 2005 -0700
| |   
| |       Merge Dracula's Amalthea radii
| |   
* | commit b28000b6b3f197942909c51731d17e34739b9689
| | Author: Dracula &lt;dracula@umi.com&gt;
| | Date:   Thu Apr 7 15:17:13 2005 -0700
| | 
| |     moons: Amalthea isn't round, give three radii.
| |   
| * commit 75d6a6fed22aa29c33b92257f4849068fe04e848
|/  Author: Wolfman &lt;wolf@umi.com&gt;
|   Date:   Thu Apr 7 15:18:13 2005 -0700
|   
|       moons: add Sinope and Pasipha&#235; (far out).
|  
* commit 7c8b64a1762c4701a4068e601dfe8ad56e591bda
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:16:13 2005 -0700
| 
|     moons: add Himalia and Elara (small, but closer to big moons).
|  
* commit 7edafb02ba4719cdd0a59ae3759dc470dfb24e31
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:15:13 2005 -0700
| 
|     moons: add Amalthea (nicer view of Jupiter).
|  
* commit de55da5cb2aa7b48fbe9e859894c1ee1b472fa4b
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:14:13 2005 -0700
| 
|     moons: fix typo Calisto -&gt; Callisto.
|  
* commit 7c0da882b9df3b3fe003b7caa05ba6faff9c8b90
  Author: Dracula &lt;dracula@umi.com&gt;
  Date:   Thu Apr 7 15:13:13 2005 -0700
  
      Add Jupiter's moons (Io, Europa, Ganymede, and Calisto).</span>
</pre>

      <p>
        Dracula wants to merge Wolfman's two new commits.
        However, when Dracula tries to merge Wolfman's changes,
      </p>

<pre>
<span class="out">$ </span><span class="in">git merge wolfman/master</span>
<span class="out">Auto-merging moons.txt
CONFLICT (content): Merge conflict in moons.txt
Automatic merge failed; fix conflicts and then commit the result.</span>
</pre>

      <p class="continue">
        Git tells him he can't.
        There is an actual conflict in the file.
        To help you resolve the conflict,
        Git modifies the file in question (<code>moons.txt</code>)
        in a way that interleaves Dracula's changes
        and the changes from Wolfman's branch.
        Wherever there is a conflict,
        Git inserts the line <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</code>
        followed by the lines from the local copy of the file.
        It then inserts the separator <code>=======</code>,
        followed by the lines from the repository's file that are in conflict with that section,
        and puts <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt; wolfman/master</code> at the end:
      </p>

<pre>
<span class="out">$ </span><span class="in">cat moons.txt</span>
<span class="out">Name            Orbital Radius  Orbital Period  Mass            Radius
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
                * 10^3 km       * days          * 10^20 kg      * km
=======
                (10**3 km)      (days)          (10**20 kg)     (km)
&gt;&gt;&gt;&gt;&gt;&gt;&gt; wolfman/master
Amalthea        181.4           0.498179        0.075           131 x 73 x 67
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
=======
Himalia         11460           250.5662        0.095           85.0
Elara           11740           259.6528        0.008           40.0
Sinope          23540           724.1           0.00075         19
Pasipha&#235;        24095           764.0820        0.0003          30
&gt;&gt;&gt;&gt;&gt;&gt;&gt; wolfman/master</span>
</pre>

      <p>
        Dracula has to edit his copy of the file to resolve that conflict:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
                (10^3 km)       (days)          (10^20 kg)      (km)
Amalthea        181.4           0.498179        0.075           131 x 73 x 67
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
Himalia         11460           250.5662        0.095           85.0
Elara           11740           259.6528        0.008           40.0
Sinope          23540           724.1           0.00075         19
Pasipha&#235;        24095           764.0820        0.0003          30
</pre>

      <p>
        Once he is done, he tells Git that the conflict is resolved
      </p>

<pre>
<span class="out">$ </span><span class="in">git add moons.txt</span>
</pre>

      <p class="continue">
        and commits the merge.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "merge Wolfman's moon units and additions"</span>
<span class="out">[master 59aebf7] merge Wolfman's moon units and additions</span>
<span class="out">$ </span><span class="in">git log --graph</span>
<span class="out">*   commit 59aebf7ca8e918e9c91f3b668d5b08a9717d974b
|\  Merge: 7a139b1 e28f982
| | Author: Dracula &lt;dracula@umi.com&gt;
| | Date:   Thu Apr 7 15:22:13 2005 -0700
| | 
| |     merge Wolfman's moon units and additions
| |   
| * commit e28f982d72e60171beb8ce2ae07f3e0d04cdb3a1
| | Author: Wolfman &lt;wolf@umi.com&gt;
| | Date:   Thu Apr 7 15:20:13 2005 -0700
| | 
| |     moons: add units header.
| |     
| *   commit a2f10432f3d28c5d2fed826978e38d93cd4fd39f
| |\  Merge: 75d6a6f b28000b
| | | Author: Wolfman &lt;wolf@umi.com&gt;
| | | Date:   Thu Apr 7 15:19:13 2005 -0700
| | | 
| | |     Merge Dracula's Amalthea radii
| | |    
| * | commit 75d6a6fed22aa29c33b92257f4849068fe04e848
| | | Author: Wolfman &lt;wolf@umi.com&gt;
| | | Date:   Thu Apr 7 15:18:13 2005 -0700
| | | 
| | |     moons: add Sinope and Pasipha&#235; (far out).
| | |    
* | | commit 7a139b1a9e355fde53edb68814de13526708c091
| |/  Author: Dracula &lt;dracula@umi.com&gt;
|/|   Date:   Thu Apr 7 15:21:13 2005 -0700
| |   
| |       moons: add units for physical data columns.
| |   
* | commit b28000b6b3f197942909c51731d17e34739b9689
|/  Author: Dracula &lt;dracula@umi.com&gt;
|   Date:   Thu Apr 7 15:17:13 2005 -0700
|   
|       moons: Amalthea isn't round, give three radii.
|  
* commit 7c8b64a1762c4701a4068e601dfe8ad56e591bda
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:16:13 2005 -0700
| 
|     moons: add Himalia and Elara (small, but closer to big moons).
|  
* commit 7edafb02ba4719cdd0a59ae3759dc470dfb24e31
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:15:13 2005 -0700
| 
|     moons: add Amalthea (nicer view of Jupiter).
|  
* commit de55da5cb2aa7b48fbe9e859894c1ee1b472fa4b
| Author: Wolfman &lt;wolf@umi.com&gt;
| Date:   Thu Apr 7 15:14:13 2005 -0700
| 
|     moons: fix typo Calisto -&gt; Callisto.
|  
* commit 7c0da882b9df3b3fe003b7caa05ba6faff9c8b90
  Author: Dracula &lt;dracula@umi.com&gt;
  Date:   Thu Apr 7 15:13:13 2005 -0700
  
      Add Jupiter's moons (Io, Europa, Ganymede, and Calisto).</span>
</pre>

      <p>
        If Dracula doesn't like working with the interpolated changes directly
        (<code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>, <code>=======</code>,
        <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>,
        there are several tools for displaying differences,
        or <a href="glossary.html#diff">diffs</a>,
        and helping to merge them.
        Git's <code>mergetool</code> command provides a simple interface for using those tools to help with a Git merge.
      </p>

<pre>
<span class="out">$ </span><span class="in">git mergetool --help</span>
<span class="out">&#8230;
OPTIONS
       -t &lt;tool&gt;, --tool=&lt;tool&gt;
           Use the merge resolution program specified by &lt;tool&gt;. Valid merge
           tools are: araxis, bc3, diffuse, ecmerge, emerge, gvimdiff, kdiff3,
           meld, opendiff, p4merge, tkdiff, tortoisemerge, vimdiff and xxdiff.
&#8230;</span>
</pre>

      <p>
        In this case, the conflict was small and easy to fix.
        However, if two or more people on a team are repeatedly creating conflicts for one another,
        it's usually a signal of deeper communication problems:
        either they aren't talking as often as they should,
        or their responsibilities overlap.
        If used properly,
        the version control system can help the team find and fix these issues
        so that the team will be more productive in future.
      </p>

    </div>

    <div class="sect" id="s:rollback">

      <h2>
        Recovering Old Versions
      </h2>

      <p>
        Now that we have seen how to merge files and resolve conflicts,
        we can look at how to use version control as an &#8220;infinite undo&#8221;.
        Suppose that Wolfman is working late one night.
        His copy of the <code>monsters</code> project is in sync with Dracula's at 59aebf7c.
        He decides to edit the file <code>moons.txt</code>,
        but unfortunately forgot that there was a full moon,
        so his changes don't make a lot of sense:
      </p>

<pre>
Just one moon can make me growl
Four would make me want to howl
&#8230;
</pre>

      <p>
        When he's back in human form the next day, he wants to undo his changes.
        Without version control, his choices would be grim.
        He could try to edit them back into their original state by hand
        (which for some reason hardly ever seems to work),
        or ask his colleagues to send him their copies of the files
        (which is almost as embarrassing as chasing the neighbor's cat when in wolf form).
      </p>

      <p>
        Since he's using Git, though,
        and hasn't committed his work to the repository,
        all he has to do is <a href="glossary.html#revert">revert</a> his local changes.
        Subversion's <code>checkout</code> command simply throws away local changes to files
        and puts things back the way they were before those changes were made.
      </p>

      <p>
        To start, Wolfman uses <code>diff</code> to look at
        what the differences actually are between
        his file and the master copy in the repository.
        He doesn't want to keep his changes, so checks out the master copy.
      </p>

<pre>
<span class="out">$ </span><span class="in">git checkout moons.txt</span>
<span class="out">$ </span><span class="in">cat moons.txt</span>
<span class="out">Name            Orbital Radius  Orbital Period  Mass            Radius
                (10**3 km)      (days)          (10**20 kg)     (km)
Amalthea        181.4           0.498179        0.075           131 x 73 x 67
Io              421.6           1.769138        893.2           1821.6
Europa          670.9           3.551181        480.0           1560.8
Ganymede        1070.4          7.154553        1481.9          2631.2
Callisto        1882.7          16.689018       1075.9          2410.3
Himalia         11460           250.5662        0.095           85.0
Elara           11740           259.6528        0.008           40.0
Sinope          23540           724.1           0.00075         19
Pasipha&#235;        24095           764.0820        0.0003          30</span>
</pre>

      <p>
        What if someone <em>has</em> committed their changes,
        but still wants to undo them?
        For example,
        suppose Dracula decides that the numbers in <code>moons.txt</code> would look better with commas.
        He edits the file:
      </p>

<pre>
Name            Orbital Radius  Orbital Period  Mass            Radius
                (10^3 km)       (days)          (10^20 kg)      (km)
Amalthea        181.4           0.498179          0.075      131 x 73 x 67
Io              421.6           1.769138        893.2          1,821.6
Europa          670.9           3.551181        480.0          1,560.8
Ganymede      1,070.4           7.154553      1,481.9          2,631.2
Callisto      1,882.7          16.689018      1,075.9          2,410.3
Himalia      11,460           250.5662            0.095           85.0
Elara        11,740           259.6528            0.008           40.0
Sinope       23,540           724.1               0.00075         19
Pasipha&#235;     24,095           764.0820            0.0003          30
</pre>

      <p class="continue">
        and then commits his changes to create commit dc7ec289.
      </p>

<pre>
<span class="out">$ </span><span class="in">git commit -m "moons: add commas and align decimal point." moons.txt</span>
<span class="out">[master dc7ec28] moons: add commas and align decimal point.
 1 file changed, 11 insertions(+), 11 deletions(-)
 rewrite moons.txt (81%)</span>
</pre>

      <p>
        A little while later,
        the Mummy sees the change and orders Dracula to put things back the way they were.
        What should Dracula do?
        In Git, the <code>HEAD</code> of a branch is just a pointer to a particular commit in the commit graph
        (in this case Dracula's <code>HEAD</code> now points to commit dc7ec28).
        If Dracula wants to pretend the comma commit never happened,
        he can just move his <code>HEAD</code> back to point to a commit that he does like.
        For example,
        <code>HEAD^</code> represents the commit before the current <code>HEAD</code>.
      </p>
 
<pre>
<span class="out">$ </span><span class="in">git reset --hard HEAD^</span>
<span class="out">HEAD is now at 59aebf7 merge Wolfman's moon units and additions</span>
</pre>

     <p>
        This works well if Dracula hasn't published his repository since making the abandoned commit.
        If he had published the commit and Wolfman had pulled it,
        rewinding <code>HEAD</code> to drop commit dc7ec28 would have no effect.
        Wolfman will still base his future work off the commit,
        and Dracula will have to pull it back in the next time he merges Wolfman's branch.
        A safer course would be for Dracula to make a new commit explicitly reverting the bad commit.
      </p>

<pre>
<span class="out">$ </span><span class="in">git revert dc7ec28</span>
<span class="out">[master b5e1241] Revert "moons: add commas and align decimal point."
 1 file changed, 11 insertions(+), 11 deletions(-)
 rewrite moons.txt (82%)</span>
<span class="out">$ </span><span class="in">git log</span>
<span class="out">commit b5e1241fd28404a33b76cfbcf2d6730d88b23b0b
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:24:13 2005 -0700

    Revert "moons: add commas and align decimal point."
    
    This reverts commit dc7ec2898eb5cfcba9d4909fb589bdc7b98327fd.

commit dc7ec2898eb5cfcba9d4909fb589bdc7b98327fd
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:23:13 2005 -0700

    moons: add commas and align decimal point.

commit 59aebf7ca8e918e9c91f3b668d5b08a9717d974b
Merge: 7a139b1 e28f982
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:22:13 2005 -0700

    merge Wolfman's moon units and additions

commit 7a139b1a9e355fde53edb68814de13526708c091
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:21:13 2005 -0700

    moons: add units for physical data columns.

commit e28f982d72e60171beb8ce2ae07f3e0d04cdb3a1
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:20:13 2005 -0700

    moons: add units header.

commit a2f10432f3d28c5d2fed826978e38d93cd4fd39f
Merge: 75d6a6f b28000b
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:19:13 2005 -0700

    Merge Dracula's Amalthea radii

commit 75d6a6fed22aa29c33b92257f4849068fe04e848
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:18:13 2005 -0700

    moons: add Sinope and Pasipha&#235; (far out).

commit b28000b6b3f197942909c51731d17e34739b9689
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:17:13 2005 -0700

    moons: Amalthea isn't round, give three radii.

commit 7c8b64a1762c4701a4068e601dfe8ad56e591bda
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:16:13 2005 -0700

    moons: add Himalia and Elara (small, but closer to big moons).

commit 7edafb02ba4719cdd0a59ae3759dc470dfb24e31
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:15:13 2005 -0700

    moons: add Amalthea (nicer view of Jupiter).

commit de55da5cb2aa7b48fbe9e859894c1ee1b472fa4b
Author: Wolfman &lt;wolf@umi.com&gt;
Date:   Thu Apr 7 15:14:13 2005 -0700

    moons: fix typo Calisto -&gt; Callisto.

commit 7c0da882b9df3b3fe003b7caa05ba6faff9c8b90
Author: Dracula &lt;dracula@umi.com&gt;
Date:   Thu Apr 7 15:13:13 2005 -0700

    Add Jupiter's moons (Io, Europa, Ganymede, and Calisto).</span>
</pre>

      <p>
        One benefit of the <code>revert</code> command over the <code>reset</code> command is that it can be used to revert an earlier commit even if you have made subsequent commits on top of the bad commit.
      </p>

    </div>

    <div class="sect" id="s:branches">

      <h2>
        Branched Development
      </h2>

      <p>
        The most frequent use of merging is to manage parallel streams of development in large projects,
        where the merging is not as frequent as it was in the <code>moons.txt</code> example above.
        Suppose that Universal Monsters has just released a new program for designing secret lairs.
        Dracula and Wolfman are supposed to start adding a few features
        that had to be left out of the first release because time ran short.
        At the same time, Frankenstein and the Mummy are doing technical support:
        their job is to fix any bugs that users find.
        All sorts of things could go wrong if both teams were constantlytried to work on the same code at the same time.
        For example,
        if Frankenstein fixed a bug and sent a new copy of the program to a user in Greenland,
        it would be all too easy for him to accidentally include
        the half-completed shark tank control feature that Wolfman was working on.
      </p>

      <p>
        The usual way to handle this situation is
        to create a <a href="glossary.html#branch">branch</a> in the repository for each major sub-project.
        While Wolfman and Dracula work on the <a href="glossary.html#master">master branch</a>,
        Frankenstein and the Mummy create a branch,
        which is just another nickname for a commit in the commit graph.
        They can work in their branch without disturbing Wolfman and Dracula and vice versa:
      </p>

<pre>
      x---y---z  [shark-tank]
     /         \
I---a---b---c---d---e  [master]
     \       :
      r-------s  [1.0.x]
</pre>

      <p>
        With development at commit <code>a</code>,
        Dracula could create the <code>shark-tank</code> branch with Git's <code>branch</code> command.
        Then he can change to the <code>shark-tank</code> branch using Git's <code>checkout</code> command.</p>

<pre>
<span class="out">$ </span><span class="in">git branch --all</span>
<span class="out">* master
  remotes/wolfman/master</span>
<span class="out">$ </span><span class="in">git branch shark-tank</span>
<span class="out">$ </span><span class="in">git checkout shark-tank</span>
<span class="out">Switched to branch 'shark-tank'</span>
<span class="out">$ </span><span class="in">git branch --all</span>
<span class="out">  master
* shark-tank
  remotes/wolfman/master</span>
</pre>

      <p>
        Branches in version control repositories are often described as &#8220;parallel universes&#8221;.
        Each branch starts off as a clone of the project at some moment in time
        (typically each time the software is released,
        or whenever work starts on a major new feature.
        Commit <code>a</code> in the above figure).
        Changes made to a branch only affect that branch,
        just as changes made to the files in one directory don't affect files in other directories.
        However,
        the branches are all stored in the same repository,
        so it is easy to compare and merge the two code bases.
      </p>

      <p>
        When development of the shark tank controller finishes in commit <code>z</code>,
        the code is merged back into the master branch with commit <code>d</code>.
        Meanwhile, Frankenstein and Mummy fixed a bug that only applied to the 1.0.x release with <code>r</code>.
        Then they <code>cherry-picked</code> another bugfix from commit <code>c</code> with commit <code>s</code>.
        With each change to the 1.0.x branch,
        they make a bugfix release
        (e.g. <code>a</code> is 1.0.0, <code>r</code> is 1.0.1, &#8230;).
      </p>

      <p>
        Merging with a branch from within your repository is the same as merging with a branch from a remote repository.
        In the <code>moons.txt</code> example,
        Dracula merged Wolfman's master branch with:
      </p>

<pre>
<span class="out">$ </span><span class="in">git merge wolfman/master</span>
</pre>

      <p>
        When development on the <code>shark-tank</code> branch finishes,
        he'll merge it into the <code>master</code> branch with.
      </p>

<pre>
<span class="out">$ </span><span class="in">git checkout master</span>
<span class="out">$ </span><span class="in">git merge shark-tank</span>
</pre>

      <p>
        Branching helps projects scale up by letting sub-teams work independently,
        but too many branches can cause as many problems as they solve.
        Karl Fogel's excellent book
        <a href="bibliography.html#fogel-producing-oss"><cite>Producing Open Source Software</cite></a>,
        and Laura Wingerd and Christopher Seiwald's paper
        &#8220;<a href="bibliography.html#wingerd-seiwald-scm">High-level Best Practices in Software Configuration Management</a>&#8221;,
        talk about branches in much more detail.
        Projects usually don't need to do this until they have a dozen or more developers,
        or until several versions of their software are in simultaneous use,
        but using branches is a key part of switching from carpentry to
        <a href="engineering.html">engineering</a>.
      </p>

    </div>

    <div class="sect" id="s:publish">

      <h2>
        Setting up a Public Repository
      </h2>

      <p>
        In the <code>moons.txt</code> example,
        Dracula and Wolfman could fetch each other's repository directly from a shared file system.
        However, you will often want to collaborate on development where you don't have such a simple way to share your work.
        There are a number of ways to setup a public repository,
        you can
      </p>

      <ul>

        <li>
          ask your system administrator to set it up for you or
        </li>

        <li>
          use a hosting service like <a href="http://http://gitorious.org/">Gitorious</a>
          or <a href="https://github.com/">GitHub</a>.
        </li>

      </ul>

      <p class="continue">
        If you choose the second option,
        please check with whoever handles intellectual property at your institution
        to make sure that putting your work on a commercially-operated machine
        that is probably in some other legal jurisdiction
        isn't going to cause trouble.
        Many people assume that it's &#8220;just OK&#8221;,
        while others act as if not having asked will be an acceptable defense later on.
        Unfortunately,
        neither is true&#8230;
      </p>

      <p>
        If you want to host your own repository, you can host a
        private repository via secure shell (SSH) or host a public
        repository via
      </p>

      <ul>

        <li>
          <code>git-daemon</code> (<code>git://</code>),
        </li>

        <li>
          <code>git-http-backend</code> (efficient <code>http://</code>), or
        </li>

        <li>
          <code>hooks/post-update</code> (inefficient <code>http://</code>).
        </li>

      </ul>

    </div>

    <div class="sect" id="s:summary">

      <h2>
        Summing Up
      </h2>

      <p class="fixme">summarize</p>

    </div>

    <div class="footer">
      <hr/>
      <table>
        <tr>
          <td valign="middle">
            <img src="../img/logo/creative-commons-attribution-license.png" alt="CC-A license"/>
          </td>
          <td valign="middle">
            This material is provided under the
            <a href="http://creativecommons.org/licenses/by/3.0/legalcode">Creative Commons Attribution</a> license.
            <br/>
            Please contact <a href="mailto:info@software-carpentry.org">info@software-carpentry.org</a> for details.
          </td>
        </tr>
      </table>
    </div>

  </body>
</html>